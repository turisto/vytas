<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Micro Java EE application with Wildfly Swarm | vytas.io</title>

	<meta property="og:title" content="Micro Java EE application with Wildfly Swarm">
	<meta property="og:description" content=" 
Microservices are here already for a while. They came with cloud solutions, RESTful services, Backbone.js , 
AngularJS  and other javascript frameworks, however only recently they got a new keyword - "microservices".
And of course they will stay. Due to the nature of nowadays software architecture, cloud hosting and client rendering.
I you want to be pragmatic and lean - you do not need microservices. If your software is complex, it needs easy support, fast deployment, easy clustering and serving for a single module (e.g. finance module within huge
CRM) then you might thing about going into microservices.
And here Wildfly Swarm comes in.


">
		
	<link rel="canonical" href="http://vytas.io/blog/java/micro-java-ee-application-with-wildfly-swarm/">
	<link rel="shortcut icon" type="image/png" href="images/author.jpg"/>
		
<!--CUSTOM CSS-->
<link href="/css/custom.css" rel="stylesheet" type="text/css">
<!--BOOTSTRAP 3.3.5-->
<link href="/css/bootstrap.css" rel="stylesheet" type="text/css">
<!--RESPONSIVE-->
<link href="/css/responsive.css" rel="stylesheet" type="text/css">
<!--FONT AWESOME-->
<link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<!--GOOGLE FONTS-->
<link href='http://fonts.googleapis.com/css?family=Playfair+Display:400,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Noto+Serif:400,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
<!--HTML5-->
<script src="/js/html5.js"></script>
</head>

<body class="cp_theme-style-1 cp_theme-4-bg">
<!--WRAPPER START-->
<div id="wrapper"> 
  
  <!--HEADER STYLE 1 START-->
  <header id="cp-header-style-1" class="cp-header-style-4"> 
   
    <div class="container">
      <div class="bottom-row">
        <ul class="head-4-social">
          <li><a href="https://www.facebook.com/vytas.io/"><i class="fa fa-facebook-f"></i></a></li>
          <li><a href="https://twitter.com/vytas_io"><i class="fa fa-twitter"></i></a></li>
          <li><a href="https://www.linkedin.com/in/vytasr"><i class="fa fa-linkedin"></i></a></li>
        </ul>
        
        <strong class="logo"><a href="index.html"><img src="/images/logo.png" alt="img"></a></strong> </div>
    </div>
  </header>
  <!--HEADER STYLE 1 END--> 
  
  <!--MAIN START-->
  <div id="main"> 
    <!--POST PAGE START-->
<section class="cp-post-type">
	<div class="container">
		<div class="col-md-12">
			<div class="box">
				<h2>
					<a href="#">Micro Java EE application with Wildfly Swarm</a>
				</h2>
				<div class="cp-admin-row">
					<ul>
						<li>
							<a href="/categories/java">
								<i class="fa fa-tags"></i>
								java
							</a>
						</li>
						<li>
							<a href="#">
								<i class="fa fa-calendar"></i>
								June 9, 2015
							</a>
						</li>
						 
							<li>
								<a href="/tags/java-ee">
									<i class="fa fa-tag"></i> 
									java-ee
								</a>  
							</li>
						  
							<li>
								<a href="/tags/wildfly">
									<i class="fa fa-tag"></i> 
									wildfly
								</a>  
							</li>
						  
							<li>
								<a href="/tags/swarm">
									<i class="fa fa-tag"></i> 
									swarm
								</a>  
							</li>
						  
							<li>
								<a href="/tags/microservices">
									<i class="fa fa-tag"></i> 
									microservices
								</a>  
							</li>
						  
							<li>
								<a href="/tags/REST">
									<i class="fa fa-tag"></i> 
									REST
								</a>  
							</li>
						  
              
              
					</ul>
				</div>
				
				<style>
.bigfont-4:before {
	content: "M";
}
</style>
				<div class="text">
					<strong class="title bigfont-4">
Microservices are here already for a while. They came with cloud solutions, RESTful services, Backbone.js , 
AngularJS  and other javascript frameworks, however only recently they got a new keyword - "microservices".
And of course they will stay. Due to the nature of nowadays software architecture, cloud hosting and client rendering.
I you want to be pragmatic and lean - you do not need microservices. If your software is complex, it needs easy support, fast deployment, easy clustering and serving for a single module (e.g. finance module within huge
CRM) then you might thing about going into microservices.
And here Wildfly Swarm comes in.


</strong>
				</div>
				
<h3>What is Wildfly Swarm?</h3>

<p>
You can think about <a href="http://wildfly.org/news/2015/06/05/WildFly-Swarm-Alpha2/" rel="nofollow">Wildfly Swarm</a>  as a micro application server with features which are required for your applications only.
And these features are embedded into one single jar together with your module. Yes, coupling with application server does not smell well, but useful in some cases. That's why I 
always say that you need to stick with your requirements and check if need such type of architecture.

</p>

<h3>Example</h3>

<p>
The easiest example to provide is REST + DB as a single microservice for a single module. You define data entities and expose them via REST endpoint. UI may be created as a separate microservice.
</p>

<h3>What you need?</h3>

<p>
Wildfly Swarm Alpha3-SNAPSHOT. Alpha1 did not support JPA and Alpha2 still has some issues which are already fixed in latest SNAPSHOT version. This means that you need to grab it from github and build yourself. 
Or wait for Alpha3 release.
</p>

<p>
Then you need some wildfly dependencies.
</p>

<pre>
&lt;dependency&gt;
	&lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt;
	&lt;artifactId&gt;wildfly-swarm-jpa&lt;/artifactId&gt;
	&lt;version&gt;${wildfly-swarm.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
	&lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt;
	&lt;artifactId&gt;wildfly-swarm-weld-jaxrs&lt;/artifactId&gt;
	&lt;version&gt;${wildfly-swarm.version}&lt;/version&gt;
&lt;/dependency&gt;
</pre>

<p>
And wildfly plugins...
</p>
<pre>
&lt;plugin&gt;
	&lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt;
	&lt;artifactId&gt;wildfly-swarm-plugin&lt;/artifactId&gt;
	&lt;version&gt;${wildfly-swarm.version}&lt;/version&gt;
	&lt;configuration&gt;
		&lt;mainClass&gt;org.aracrown.blog.s01e04.Main&lt;/mainClass&gt;
	&lt;/configuration&gt;
	&lt;executions&gt;
		&lt;execution&gt;
			&lt;goals&gt;
				&lt;goal&gt;package&lt;/goal&gt;
			&lt;/goals&gt;
		&lt;/execution&gt;
	&lt;/executions&gt;
&lt;/plugin&gt;
</pre>

<p>
And some code... Ok, <a href="https://github.com/aracrown/ara-blog-examples/tree/master/s01e04" rel="nofollow">source is in Git repository</a>, I will not repeat myself here :)
</p>

<p>
And the main thing, which comes to Wildfly swarm - configuration! So far you need a Java class with main method in order to be able to start it as a regular jar archive. That's the place where nasty things happen :)

</p>
<pre>
package org.aracrown.blog.s01e04;

import org.aracrown.blog.s01e04.dao.BlogEntryDao;
import org.aracrown.blog.s01e04.model.BlogEntry;
import org.aracrown.blog.s01e04.query.BlogEntryQueryImpl;
import org.aracrown.blog.s01e04.resources.BlogEntriesResource;
import org.jboss.shrinkwrap.api.asset.ClassLoaderAsset;
import org.wildfly.swarm.container.Container;
import org.wildfly.swarm.datasources.Datasource;
import org.wildfly.swarm.datasources.DatasourceDeployment;
import org.wildfly.swarm.datasources.DriverDeployment;
import org.wildfly.swarm.jaxrs.JAXRSDeployment;

public class Main {
	public static void main(String[] args) throws Exception {
		Container container = new Container();
		container.start();

		DriverDeployment driverDeployment = new DriverDeployment(container, "com.h2database:h2", "h2");
		container.deploy(driverDeployment);

		// Create a DS deployment
		DatasourceDeployment dsDeployment = new DatasourceDeployment(container, new Datasource("ExampleDS")
				.connectionURL("jdbc:h2:mem:test;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE").driver("h2").authentication("sa", "sa"));
		container.deploy(dsDeployment);

		JAXRSDeployment deployment = new JAXRSDeployment(container);
		deployment.getArchive().addClasses(BlogEntryDao.class, BlogEntryQueryImpl.class);
		deployment.getArchive().addPackage(BlogEntry.class.getPackage());
		deployment.getArchive().addPackage(BlogEntriesResource.class.getPackage());
		deployment.getArchive().addAsWebInfResource(new ClassLoaderAsset("META-INF/persistence.xml", Main.class.getClassLoader()),
				"classes/META-INF/persistence.xml");
		deployment.getArchive().addAsWebInfResource(new ClassLoaderAsset("META-INF/load.sql", Main.class.getClassLoader()),
				"classes/META-INF/load.sql");
		deployment.getArchive().addAsWebInfResource(new ClassLoaderAsset("META-INF/beans.xml", Main.class.getClassLoader()),
				"classes/META-INF/beans.xml");

		container.deploy(deployment);
	}
}

</pre>

<p>
You tell the container to use JAX-RS and datasource modules only. You can expose your configuration properties to external properties file, but what you need is adding classes and resources into archive manually.
Executing maven goal <strong>mvn package</strong> will create you a single jar containing all required dependencies with a suffix <strong>"-swarm"</strong>.
</p>

<p>
And at the end you have a single jar file and you can distribute it onto as many servers as you need. and run with just a single line: 
</p>

<pre>java -jar target/s01e04-1.0.0-SNAPSHOT-swarm.jar</pre>

<p>REST resource call would look like</p>
<pre>curl -v http://localhost:8080/blogs/</pre>
<p>And result:</p>

<pre>
* Hostname was NOT found in DNS cache
*   Trying ::1...
* Connected to localhost (::1) port 8080 (#0)
&gt; GET /blogs/ HTTP/1.1
&gt; User-Agent: curl/7.37.1
&gt; Host: localhost:8080
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 OK
&lt; Connection: keep-alive
&lt; Content-Type: application/json
&lt; Content-Length: 755
&lt; Date: Wed, 10 Jun 2015 18:37:26 GMT
&lt; 
* Connection #0 to host localhost left intact
{"total":12,"count":10,"pageSize":10,"currentPage":0,"items":[{"id":1,"title":"Wildfly Swarm with JPA and REST1","author":"Penny"},{"id":2,"title":"Wildfly Swarm with JPA and REST2","author":"Penny"},{"id":3,"title":"Wildfly Swarm with JPA and REST3","author":"Penny"},{"id":4,"title":"Wildfly Swarm with JPA and REST4","author":"Penny"},{"id":5,"title":"Wildfly Swarm with JPA and REST5","author":"Penny"},{"id":6,"title":"Wildfly Swarm with JPA and REST6","author":"Penny"},{"id":7,"title":"Wildfly Swarm with JPA and REST7","author":"Penny"},{"id":8,"title":"Wildfly Swarm with JPA and REST8","author":"Penny"},{"id":9,"title":"Wildfly Swarm with JPA and REST9","author":"Penny"},{"id":10,"title":"Wildfly Swarm with JPA and REST10","author":"Penny"}]}

</pre>
<h3>Resources</h3>

<ul>
<li><a href="https://github.com/aracrown/ara-blog-examples/tree/master/s01e04" rel="nofollow">Source in Git repository</a></li>
<li><a href="https://github.com/wildfly-swarm/wildfly-swarm-examples" rel="nofollow">Wildfly-Swarm examples privided by Wildfly</a></li>

</ul>

<h3>Talks and discussions</h3>

<ul>
<li><a href="https://www.chrisstucchio.com/blog/2014/microservices_for_the_grumpy_neckbeard.html" rel="nofollow">Microservices for the Grumpy Neckbeard</a></li>
<li><a href="http://www.boundary.com/blog/2014/08/microservices-conways-law/" rel="nofollow">Microservices, or How I Learned To Stop Making Monoliths and Love Conway’s Law</a></li>
<li><a href="http://rick-hightower.blogspot.fi/2015/03/java-microservices-architecture.html" rel="nofollow">Java Microservices Architecture</a></li>
<li><a href="http://martinfowler.com/bliki/MonolithFirst.html" rel="nofollow">MonolithFirst</a></li>
<li><a href="http://bravenewgeek.com/service-disoriented-architecture/" rel="nofollow">Service-Disoriented Architecture</a></li>

</ul>

<p>
Happy designing and coding! 
</p>

				<div class="share-row">
					<h4>Share on</h4>
					<ul>
						<li class="color-1">
							<a onclick="window.open('http://www.facebook.com/sharer.php?u=http://vytas.io/blog/java/micro-java-ee-application-with-wildfly-swarm/','Facebook','width=600,height=300,left='+(screen.availWidth/2-300)+',top='+(screen.availHeight/2-150)+''); return false;" 
								href="http://www.facebook.com/sharer.php?u=http://vytas.io/blog/java/micro-java-ee-application-with-wildfly-swarm/">
								<i class="fa fa-facebook"></i>
								Facebook
							</a>
						</li>
						<li class="color-2">
							<a onclick="window.open('http://twitter.com/share?url=http://vytas.io/blog/java/micro-java-ee-application-with-wildfly-swarm/&amp;text=Micro Java EE application with Wildfly Swarm','Twitter share','width=600,height=300,left='+(screen.availWidth/2-300)+',top='+(screen.availHeight/2-150)+''); return false;" href="http://twitter.com/share?url=http://vytas.io/blog/java/micro-java-ee-application-with-wildfly-swarm/&amp;text=Micro Java EE application with Wildfly Swarm">
								<i class="fa fa-twitter"></i>
								Twitter
							</a>
						</li>
						<li class="color-3">
							<a onclick="window.open('https://plus.google.com/share?url=http://vytas.io/blog/java/micro-java-ee-application-with-wildfly-swarm/','Google plus','width=585,height=666,left='+(screen.availWidth/2-292)+',top='+(screen.availHeight/2-333)+''); return false;" href="https://plus.google.com/share?url=http://vytas.io/blog/java/micro-java-ee-application-with-wildfly-swarm/">
								<i class="fa fa-google-plus"></i>
								Google+
							</a>
						</li>
						<li class="color-4">
							<a onclick="window.open('http://www.linkedin.com/shareArticle?mini=true&amp;url=http://vytas.io/blog/java/micro-java-ee-application-with-wildfly-swarm/','Linkedin','width=863,height=500,left='+(screen.availWidth/2-431)+',top='+(screen.availHeight/2-250)+''); return false;" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://vytas.io/blog/java/micro-java-ee-application-with-wildfly-swarm/">
								<i class="fa fa-linkedin"></i>
								Linkedin
							</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="box-2">
				<div class="frame">
					<a href="#">
						<img src="/images/author.jpg" alt="img" style="width: 71px">
					</a>
				</div>
				<div class="text-box">
					<h4>
						<a href="#">vytas</a>
					</h4>
					<p>Senior software engineer, software architect for java enterprise based solutions</p>
					
				</div>
			</div>
			
			<div class="next-prev-row">
				<div class="row">
					<div class="col-md-6">
						
						<div class="next-box">
							
							<div class="text-box">
								<a href="/blog/java/writing-type-safe-queries-with-querydsl/">
									<h2>Previous Post</h2>
									<p>Writing type-safe JPA queries with QueryDSL</p>
								</a>
							</div>
						</div>
						 
					</div>
					<div class="col-md-6">
						 
						<div class="prev-box">
							
							<div class="text-box">
								<a href="/blog/java/java-object-to-object-mapping-which-framework-to-choose/">
									<h2>Next Post</h2>
									<p>Java object to object mapping - which framework to choose? - Part 1</p>
								</a>
							</div>
						</div>
						 
					</div>
				</div>
			</div>
			
		</div>
		
	</div>
</section>
<!--POST PAGE END-->

  </div>
  <!--MAIN END--> 
   
  <!--FOOTER START-->
  <section id="footer">
    <div class="container">
      
      <div class="footer-bottom-section"> <strong class="copy">Powered by <a href="http://vytas.io/">vytas.io</a></strong> <a href="#" class="btn-back-top">Back to Top<i class="fa fa-angle-up"></i></a> </div>
    </div>
  </section>
  <!--FOOTER END--> 
</div>
<!--WRAPPER END--> 
<!--JQUERY 1.11.3--> 
<script src="/js/jquery-1.11.3.min.js"></script> 
<!--BOOTSTRAP 3.3.5--> 
<script src="/js/bootstrap.min.js"></script>
</body>
</html>
