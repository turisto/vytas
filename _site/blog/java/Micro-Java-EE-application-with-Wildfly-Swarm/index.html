<!DOCTYPE html>
<html lang="en-US" style="overflow-y: hidden;">

<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>
		<title>vytas.io - Micro Java EE application with Wildfly Swarm - vytas.io</title>
		<meta property="og:title" content="Micro Java EE application with Wildfly Swarm">
		<meta property="og:description" content=" 
Microservices are here already for a while. They came with cloud solutions, RESTful services, Backbone.js , 
AngularJS  and other javascript frameworks, however only recently they got a new keyword - "microservices".
And of course they will stay. Due to the nature of nowadays software architecture, cloud hosting and client rendering.
I you want to be pragmatic and lean - you do not need microservices. If your software is complex, it needs easy support, fast deployment, easy clustering and serving for a single module (e.g. finance module within huge
CRM) then you might thing about going into microservices.
And here Wildfly Swarm comes in.


">
		
		<link rel="canonical" href="http://vytas.io/blog/java/Micro-Java-EE-application-with-Wildfly-Swarm/">
		
		
		<link rel="stylesheet" type="text/css" media="all" href="/css/bootstrap.min.css"/>
		<link rel="stylesheet" type="text/css" media="all" href="/css/font-awesome.min.css"/>
		<link rel="stylesheet" type="text/css" media="all" href="/css/style.css"/>
		<link rel="stylesheet" id="dropmenu-css" href="/css/dropmenu.css?ver=4.0.8" type="text/css" media="all"/>
		<link rel="stylesheet" id="styles-css" href="/css/styles.css?ver=4.0.8" type="text/css" media="all"/>
		<link rel="stylesheet" id="list-styles-css" href="/css/fa-list.css?ver=4.0.8" type="text/css" media="all"/>
		<link rel="stylesheet" id="justifiedGallery.min-css" href="/css/justifiedGallery.min.css?ver=4.0.8" type="text/css" media="all"/>
		<link rel="stylesheet" id="swipebox-css" href="/js/swipebox/swipebox.css?ver=4.0.8" type="text/css" media="all"/>
		<link rel="stylesheet" id="custom-styles-css" href="/css/custom.css?ver=4.0.8" type="text/css" media="all"/>
		<link rel="stylesheet" id="google-fonts-css" href="http://fonts.googleapis.com/css?family=Merriweather%3A300%7CRaleway%3A700%2C400&amp;ver=1415600913" type="text/css" media="all"/>
		<script type="text/javascript">
/* <![CDATA[ */
var inafx_theme = {"niceScroll":"1","stickyHeader":"0"};
/* ]]> */
</script>
		<script type="text/javascript" src="/js/jquery-2.1.1.min.js"></script>
		<meta name="generator" content="WordPress 4.0.8"/>
		<link rel="shortcut icon" type="image/png" href="images/author.jpg | prepend: site.baseurl }}"/>
	</head>
	
	
	

<body class="home blog wide ajax-inafx-likes" role="document">
		<div class="page-wrapper">
			<header id="header-wrapper">
				<div id="header">
					<div class="container">
						<div class="row">
							<div class="col-sm-12">
								<div class="logo">
									<div class="logo-text">
										<a href="http://vytas.io/">
            								vytas.io        
            							</a>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="navbar-wrapper">
						<div class="navbar navbar-small dropmenu" role="banner">
							<div class="container">
								<nav id="nav-dropdown-menu1" class="nav-dropdown-menu collapse navbar-collapse">
									<ul id="menu-top-menu" class="nav">
										<li id="menu-item-198" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-198 dropdown">
											<a title="Home" href="/index.html" class="dropdown-toggle" aria-haspopup="true">
												Home
											</a>
										</li>
										<li id="menu-item-198" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-198 dropdown">
											<a title="Java" href="/categories/java/" class="dropdown-toggle" aria-haspopup="true">
												Java
											</a>
										</li>
										<li id="menu-item-198" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-198 dropdown">
											<a title="Bookmarks" href="index.html" class="dropdown-toggle" aria-haspopup="true">
												Bookmarks
												<span class="fa fa-angle-down"></span>
											</a>
											<ul role="menu" class="dropdown-menu" style="display: none; position: absolute;">
	
	<li id="menu-item-174" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-174">
		<a title="Features" href="/categories/tools/">Tools</a>
	</li>
	<li id="menu-item-174" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-174">
		<a title="Features" href="/categories/startups/">Startups</a>
	</li>
	<li id="menu-item-174" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-174">
		<a title="Features" href="/categories/websites/">Websites</a>
	</li>
	<li id="menu-item-174" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-174">
		<a title="Features" href="/categories/robots/">Robots</a>
	</li>
	<li id="menu-item-174" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-174">
		<a title="Features" href="/categories/space/">Space</a>
	</li>
	<li id="menu-item-174" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-174">
		<a title="Features" href="/categories/technologies/">Technologies</a>
	</li>
	<li id="menu-item-174" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-174">
		<a title="Features" href="/categories/cars/">Cars</a>
	</li>
											</ul>
										</li>
									</ul>
								</nav>
							</div>
						</div>
					</div>
				</div>
			</header>

		</div>
		<div id="main" style="padding-top: 0px;">
			<div id="content">
				<div class="container">
					<div class="row">
						<article id="post-58" class="post-58 post type-post status-publish format-standard has-post-thumbnail hentry category-photography tag-featured tag-vintage">
                                                        <!-- ## zoom-box start ## -->
                
                
               
                <!-- ## zoom-box end ## -->
                            <!-- ## post-entry start ## -->
    <div class="row post-entry">
        <!-- ## title start ## -->
        <div class="col-sm-12">
            <!-- ## post-header start ## -->
<header class="post-header">
    <!-- ## post-title ## -->
    <h2 class="post-title">
    Micro Java EE application with Wildfly Swarm
    </h2>
</header>
<!-- ## post-header end ## -->        </div>
        <!-- ## title end ## -->
        <!-- ## entry-meta start ## -->
        <div class="col-sm-12 entry-meta">
                        <span class="meta"><span class="fa fa-file-text-o"></span></span>            
                         
                                 <span class="meta"> On <span class="date"><time class="entry-date">June 9, 2015</time></span></span>   
                            	<span class="meta">
                                          <span class="fa fa-folder-open-o"></span>
                                          <span class="categories-links">
                                          	<a href="/categories/java/" rel="category tag">java</a>
                                          </span></span>        </div>
        <!-- ## entry-meta end ## -->
        <!-- ## entry-content start ## -->
<div class="col-sm-12 entry-content">
<p><span style="color: #000000;">

<p>
Microservices are here already for a while. They came with cloud solutions, RESTful services, <a href="http://backbonejs.org/" rel="nofollow">Backbone.js</a> , 
<a href="https://angularjs.org/" rel="nofollow">AngularJS</a>  and other javascript frameworks, however only recently they got a new keyword - "microservices".
And of course they will stay. Due to the nature of nowadays software architecture, cloud hosting and client rendering.
I you want to be pragmatic and lean - you do not need microservices. If your software is complex, it needs easy support, fast deployment, easy clustering and serving for a single module (e.g. finance module within huge
CRM) then you might thing about going into microservices.
And here <a href="http://wildfly.org/news/2015/06/05/WildFly-Swarm-Alpha2/" rel="nofollow">Wildfly Swarm</a> comes in.

</p>

<h3>What is Wildfly Swarm?</h3>

<p>
You can think about <a href="http://wildfly.org/news/2015/06/05/WildFly-Swarm-Alpha2/" rel="nofollow">Wildfly Swarm</a>  as a micro application server with features which are required for your applications only.
And these features are embedded into one single jar together with your module. Yes, coupling with application server does not smell well, but useful in some cases. That's why I 
always say that you need to stick with your requirements and check if need such type of architecture.

</p>

<h3>Example</h3>

<p>
The easiest example to provide is REST + DB as a single microservice for a single module. You define data entities and expose them via REST endpoint. UI may be created as a separate microservice.
</p>

<h3>What you need?</h3>

<p>
Wildfly Swarm Alpha3-SNAPSHOT. Alpha1 did not support JPA and Alpha2 still has some issues which are already fixed in latest SNAPSHOT version. This means that you need to grab it from github and build yourself. 
Or wait for Alpha3 release.
</p>

<p>
Then you need some wildfly dependencies.
</p>

<pre>
&lt;dependency&gt;
	&lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt;
	&lt;artifactId&gt;wildfly-swarm-jpa&lt;/artifactId&gt;
	&lt;version&gt;${wildfly-swarm.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
	&lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt;
	&lt;artifactId&gt;wildfly-swarm-weld-jaxrs&lt;/artifactId&gt;
	&lt;version&gt;${wildfly-swarm.version}&lt;/version&gt;
&lt;/dependency&gt;
</pre>

<p>
And wildfly plugins...
</p>
<pre>
&lt;plugin&gt;
	&lt;groupId&gt;org.wildfly.swarm&lt;/groupId&gt;
	&lt;artifactId&gt;wildfly-swarm-plugin&lt;/artifactId&gt;
	&lt;version&gt;${wildfly-swarm.version}&lt;/version&gt;
	&lt;configuration&gt;
		&lt;mainClass&gt;org.aracrown.blog.s01e04.Main&lt;/mainClass&gt;
	&lt;/configuration&gt;
	&lt;executions&gt;
		&lt;execution&gt;
			&lt;goals&gt;
				&lt;goal&gt;package&lt;/goal&gt;
			&lt;/goals&gt;
		&lt;/execution&gt;
	&lt;/executions&gt;
&lt;/plugin&gt;
</pre>

<p>
And some code... Ok, <a href="https://github.com/aracrown/ara-blog-examples/tree/master/s01e04" rel="nofollow">source is in Git repository</a>, I will not repeat myself here :)
</p>

<p>
And the main thing, which comes to Wildfly swarm - configuration! So far you need a Java class with main method in order to be able to start it as a regular jar archive. That's the place where nasty things happen :)

</p>
<pre>
package org.aracrown.blog.s01e04;

import org.aracrown.blog.s01e04.dao.BlogEntryDao;
import org.aracrown.blog.s01e04.model.BlogEntry;
import org.aracrown.blog.s01e04.query.BlogEntryQueryImpl;
import org.aracrown.blog.s01e04.resources.BlogEntriesResource;
import org.jboss.shrinkwrap.api.asset.ClassLoaderAsset;
import org.wildfly.swarm.container.Container;
import org.wildfly.swarm.datasources.Datasource;
import org.wildfly.swarm.datasources.DatasourceDeployment;
import org.wildfly.swarm.datasources.DriverDeployment;
import org.wildfly.swarm.jaxrs.JAXRSDeployment;

public class Main {
	public static void main(String[] args) throws Exception {
		Container container = new Container();
		container.start();

		DriverDeployment driverDeployment = new DriverDeployment(container, "com.h2database:h2", "h2");
		container.deploy(driverDeployment);

		// Create a DS deployment
		DatasourceDeployment dsDeployment = new DatasourceDeployment(container, new Datasource("ExampleDS")
				.connectionURL("jdbc:h2:mem:test;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE").driver("h2").authentication("sa", "sa"));
		container.deploy(dsDeployment);

		JAXRSDeployment deployment = new JAXRSDeployment(container);
		deployment.getArchive().addClasses(BlogEntryDao.class, BlogEntryQueryImpl.class);
		deployment.getArchive().addPackage(BlogEntry.class.getPackage());
		deployment.getArchive().addPackage(BlogEntriesResource.class.getPackage());
		deployment.getArchive().addAsWebInfResource(new ClassLoaderAsset("META-INF/persistence.xml", Main.class.getClassLoader()),
				"classes/META-INF/persistence.xml");
		deployment.getArchive().addAsWebInfResource(new ClassLoaderAsset("META-INF/load.sql", Main.class.getClassLoader()),
				"classes/META-INF/load.sql");
		deployment.getArchive().addAsWebInfResource(new ClassLoaderAsset("META-INF/beans.xml", Main.class.getClassLoader()),
				"classes/META-INF/beans.xml");

		container.deploy(deployment);
	}
}

</pre>

<p>
You tell the container to use JAX-RS and datasource modules only. You can expose your configuration properties to external properties file, but what you need is adding classes and resources into archive manually.
Executing maven goal <strong>mvn package</strong> will create you a single jar containing all required dependencies with a suffix <strong>"-swarm"</strong>.
</p>

<p>
And at the end you have a single jar file and you can distribute it onto as many servers as you need. and run with just a single line: 
</p>

<pre>java -jar target/s01e04-1.0.0-SNAPSHOT-swarm.jar</pre>

<p>REST resource call would look like</p>
<pre>curl -v http://localhost:8080/blogs/</pre>
<p>And result:</p>

<pre>
* Hostname was NOT found in DNS cache
*   Trying ::1...
* Connected to localhost (::1) port 8080 (#0)
&gt; GET /blogs/ HTTP/1.1
&gt; User-Agent: curl/7.37.1
&gt; Host: localhost:8080
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 OK
&lt; Connection: keep-alive
&lt; Content-Type: application/json
&lt; Content-Length: 755
&lt; Date: Wed, 10 Jun 2015 18:37:26 GMT
&lt; 
* Connection #0 to host localhost left intact
{"total":12,"count":10,"pageSize":10,"currentPage":0,"items":[{"id":1,"title":"Wildfly Swarm with JPA and REST1","author":"Penny"},{"id":2,"title":"Wildfly Swarm with JPA and REST2","author":"Penny"},{"id":3,"title":"Wildfly Swarm with JPA and REST3","author":"Penny"},{"id":4,"title":"Wildfly Swarm with JPA and REST4","author":"Penny"},{"id":5,"title":"Wildfly Swarm with JPA and REST5","author":"Penny"},{"id":6,"title":"Wildfly Swarm with JPA and REST6","author":"Penny"},{"id":7,"title":"Wildfly Swarm with JPA and REST7","author":"Penny"},{"id":8,"title":"Wildfly Swarm with JPA and REST8","author":"Penny"},{"id":9,"title":"Wildfly Swarm with JPA and REST9","author":"Penny"},{"id":10,"title":"Wildfly Swarm with JPA and REST10","author":"Penny"}]}

</pre>
<h3>Resources</h3>

<ul>
<li><a href="https://github.com/aracrown/ara-blog-examples/tree/master/s01e04" rel="nofollow">Source in Git repository</a></li>
<li><a href="https://github.com/wildfly-swarm/wildfly-swarm-examples" rel="nofollow">Wildfly-Swarm examples privided by Wildfly</a></li>

</ul>

<h3>Talks and discussions</h3>

<ul>
<li><a href="https://www.chrisstucchio.com/blog/2014/microservices_for_the_grumpy_neckbeard.html" rel="nofollow">Microservices for the Grumpy Neckbeard</a></li>
<li><a href="http://www.boundary.com/blog/2014/08/microservices-conways-law/" rel="nofollow">Microservices, or How I Learned To Stop Making Monoliths and Love Conway’s Law</a></li>
<li><a href="http://rick-hightower.blogspot.fi/2015/03/java-microservices-architecture.html" rel="nofollow">Java Microservices Architecture</a></li>
<li><a href="http://martinfowler.com/bliki/MonolithFirst.html" rel="nofollow">MonolithFirst</a></li>
<li><a href="http://bravenewgeek.com/service-disoriented-architecture/" rel="nofollow">Service-Disoriented Architecture</a></li>

</ul>

<p>
Happy designing and coding! 
</p>



</span>


</p>
</div>
<div class="col-sm-12 entry-meta-tags">
	<span class="tags-links">
		 <a href="/tags/java-ee" title="View posts tagged with &quot;java-ee&quot;"> java-ee</a>  
		 <a href="/tags/wildfly" title="View posts tagged with &quot;wildfly&quot;"> wildfly</a>  
		 <a href="/tags/swarm" title="View posts tagged with &quot;swarm&quot;"> swarm</a>  
		 <a href="/tags/microservices" title="View posts tagged with &quot;microservices&quot;"> microservices</a>  
		 <a href="/tags/REST" title="View posts tagged with &quot;REST&quot;"> REST</a>  
		 
	</span>
</div>
    </div>
<div class="row post-social">
    <div class="col-sm-12">
        <!-- ## inline list start ## -->
        <ul class="list-inline">
            <li><a class="fa fa-facebook" onclick="window.open('http://www.facebook.com/sharer.php?u=http://vytas.io/blog/java/Micro-Java-EE-application-with-Wildfly-Swarm/','Facebook','width=600,height=300,left='+(screen.availWidth/2-300)+',top='+(screen.availHeight/2-150)+''); return false;" href="http://www.facebook.com/sharer.php?u=http://vytas.io/blog/java/Micro-Java-EE-application-with-Wildfly-Swarm/"></a></li>
            <li><a class="fa fa-twitter" onclick="window.open('http://twitter.com/share?url=http://vytas.io/blog/java/Micro-Java-EE-application-with-Wildfly-Swarm/&amp;text=Micro Java EE application with Wildfly Swarm','Twitter share','width=600,height=300,left='+(screen.availWidth/2-300)+',top='+(screen.availHeight/2-150)+''); return false;" href="http://twitter.com/share?url=http://vytas.io/blog/java/Micro-Java-EE-application-with-Wildfly-Swarm/&amp;text=Micro Java EE application with Wildfly Swarm"></a></li>
            <li><a class="fa fa-google-plus" onclick="window.open('https://plus.google.com/share?url=http://vytas.io/blog/java/Micro-Java-EE-application-with-Wildfly-Swarm/','Google plus','width=585,height=666,left='+(screen.availWidth/2-292)+',top='+(screen.availHeight/2-333)+''); return false;" href="https://plus.google.com/share?url=http://vytas.io/blog/java/Micro-Java-EE-application-with-Wildfly-Swarm/"></a></li>
            <li><a class="fa fa-linkedin" onclick="window.open('http://www.linkedin.com/shareArticle?mini=true&amp;url=http://vytas.io/blog/java/Micro-Java-EE-application-with-Wildfly-Swarm/','Linkedin','width=863,height=500,left='+(screen.availWidth/2-431)+',top='+(screen.availHeight/2-250)+''); return false;" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://vytas.io/blog/java/Micro-Java-EE-application-with-Wildfly-Swarm/"></a></li>
                    </ul>
        <!-- ## inline list end ## -->
    </div>
</div>
<!-- ## post-social end ## -->
</article>



						
					</div>
				</div>
			</div>
			<!-- Footer -->
<footer id="footer">
				<div class="container">
					<div class="row">
						<div class="col-sm-12 footer-copyright">
							<a href="http:/vytas.io/"> vytas.io</a>
							<ul class="social list-inline">
										<li class="social_li">
											<a class="social_link " href="https://www.facebook.com/vytas.io" target="_blank">
												<span class="fa fa-facebook"/>
											</a>
										</li>
										<li class="social_li">
											<a class="social_link " href="https://www.facebook.com/vytas.io" target="_blank">
												<span class="fa fa-twitter"/>
											</a>
										</li>
										
										<li class="social_li">
											<a class="social_link " href="https://www.linkedin.com/in/vytasr" target="_blank">
												<span class="fa fa-linkedin"/>
											</a>
										</li>
									</ul>
						</div>
						
					</div>
				</div>
			</footer>
			
    		<script type="text/javascript" src="/js/bootstrap.min.js"></script>
			<script type="text/javascript" src="/js/bootstrap.dropmenu.js?ver=4.0.8"></script>
			<script type="text/javascript" src="/js/jquery.justifiedGallery.min.js?ver=4.0.8"></script>
			<script type="text/javascript" src="/js/swipebox/jquery.swipebox.min.js?ver=4.0.8"></script>
			<script type="text/javascript" src="/js/cycle/jquery.cycle.all.min.js?ver=4.0.8"></script>
			<script type="text/javascript" src="/js/detectmobilebrowser.js?ver=4.0.8"></script>
			<script type="text/javascript" src="/js/jquery.nicescroll.min.js?ver=4.0.8"></script>
			<script type="text/javascript" src="/js/app.ui.js?ver=4.0.8"></script>
		</div>
    
    	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6806880-4', 'auto');
  ga('send', 'pageview');

</script>
</body>
<a href="#top" class="scrollup" style="display: block;">
			<span class="fa fa-chevron-up"/>
		</a>
</html>
